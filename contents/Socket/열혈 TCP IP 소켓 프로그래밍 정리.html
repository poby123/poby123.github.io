<div><span style="font-weight: bold;">File Descriptor (File Handle)</span><br></div><div>&nbsp; 0 : Standard Input</div><div>&nbsp; 1 : Standard Output</div><div>&nbsp; 2 : Standard Error</div><div>&nbsp; 소켓을 생성하면 3번부터 순차적으로 디스크립터가 지정된다. (0~2번은 위에 이미 예약된 수이기 때문)</div><div><br></div><div><br></div><div><br></div><div><div style="background-color:#FCB900; font-size:inherit; color:#ffffff;"><span style="color: rgb(0, 0, 0); font-size: large; font-weight: 700;">Linux Socket Programming</span></div></div><div><span style="font-weight: bold;">소켓의 생성</span></div><div><span style="background-color: rgb(255, 255, 255); font-weight: bold;">&gt; <span style="color: rgb(235, 20, 76);">int</span> socket(int<span style="color: rgb(255, 105, 0);"> __domain</span>, int <span style="color: rgb(6, 147, 227);">__type</span>, int <span style="color: rgb(153, 0, 239);">__protocol</span>)&nbsp;</span><br></div><div><span style="background-color: rgb(255, 255, 255);">&nbsp; <span style="color: rgb(255, 105, 0); font-weight: bold;">__domain</span> : 소켓이 사용할 프로토콜 정보 전달.</span><br></div><div><div style=""><div style="font-size: inherit;">&nbsp;&nbsp;<span style="font-size: inherit;">&nbsp; -&nbsp;</span><span style="font-size: inherit; background-color: rgb(255, 255, 255);">PF_INET&nbsp; &nbsp;: IPv4</span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);"><span style="font-size: inherit;">&nbsp;&nbsp;</span><span style="font-size: inherit;">&nbsp; -&nbsp;</span><span style="font-size: inherit;">PF_INET6 : IPv6</span></span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);"><span style="font-size: inherit;">&nbsp;&nbsp;</span><span style="font-size: inherit;">&nbsp; -&nbsp;</span><span style="font-size: inherit;">PF_LOCAL : 로컬 통신을 위한 UNIX 프로토콜</span></span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);"><span style="font-size: inherit;">&nbsp;&nbsp;</span><span style="font-size: inherit;">&nbsp; -&nbsp;</span><span style="font-size: inherit;">PF_PACKET : Low Level 소켓을 위한 프로토콜</span></span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);"><span style="font-size: inherit;">&nbsp;&nbsp;</span><span style="font-size: inherit;">&nbsp; -&nbsp;</span><span style="font-size: inherit;">PF_IPX : IPX 노벨 프로토콜</span></span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);"><span style="font-size: inherit;"><br></span></span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);"><span style="font-size: inherit;"><span style="font-weight: bold;">&nbsp; </span><span style="font-weight: bold; color: rgb(6, 147, 227);">__type : </span>소켓의 타입. 소켓의 데이터 전송방식</span></span></div><div style="font-size: inherit;"><span style="font-size: inherit;">&nbsp;&nbsp;</span><span style="font-size: inherit;">&nbsp; - SOCK_STREAM : 연결지향형 소켓(데이터 경계x, 순차적. 신뢰도 높음. 바이트 기반.)</span><span style="background-color: rgb(255, 255, 255);"><span style="font-size: inherit;"><br></span></span></div><div style="font-size: inherit;"><span style="font-size: inherit;">&nbsp;&nbsp;</span><span style="font-size: inherit;">&nbsp; -&nbsp;SOCK_DGRAM : 비 연결지향형 소켓(</span><span style="font-size: inherit;">데이터 경계o,&nbsp;</span><span style="font-size: inherit;">비순차적. 신뢰도 낮음. 고속 전송 목적.)&nbsp;</span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);"><span style="font-size: inherit;"><br></span></span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);"><span style="font-size: inherit; font-weight: bold;">&nbsp; <span style="color: rgb(153, 0, 239);">__protocol :&nbsp;</span></span></span><span style="background-color: rgb(255, 255, 255); font-size: inherit;">소켓의 타입. 소켓의 데이터 전송방식</span><span style="font-size: inherit; font-weight: bold; background-color: rgb(255, 255, 255);">&nbsp;</span></div><div style="font-size: inherit;"><span style="font-size: inherit;">&nbsp;&nbsp;</span><span style="font-size: inherit;">&nbsp; - 대체로 이 인자는 0을 넘겨주면 되지만, "하나의 프로토콜 체계에서 전송방식이 여러개 존재하는 경우"를 위해 존재한다.</span></div><div style="font-size: inherit;"><span style="font-size: inherit;"><br></span></div><div style="font-size: inherit;"><span style="font-size: inherit; font-weight: bold;">&nbsp; <span style="color: rgb(235, 20, 76);">return : "성공시 파일 디스크립터, 실패시 -1 반환"</span></span></div><div style="font-size: inherit;"><span style="font-size: inherit; font-weight: bold; background-color: rgb(255, 255, 255);"><br></span></div><div style="font-size: inherit;"><span style="font-size: inherit; font-weight: bold; background-color: rgb(255, 255, 255);"><br></span></div><div style="font-size: inherit;"><span style="font-size: inherit; font-weight: bold; background-color: rgb(255, 255, 255);">&nbsp; &nbsp; &nbsp;&nbsp;</span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);"><span style="font-size: inherit;"><b>IPv4 기반의 주소표현을 위한 구조체:&nbsp;</b></span></span><span style="font-size: inherit; background-color: rgb(255, 255, 255); font-weight: bold;">sockaddr_in과 sockaddr</span></div><div style="font-size: inherit;"><div style="font-size: inherit; background-color: rgb(0, 0, 0);"><span style="color: rgb(0, 208, 132);">&nbsp;struct</span><span style="color: rgb(255, 255, 255);"> sockaddr_in {</span></div><div style="background-color: rgb(0, 0, 0); font-size: inherit;"><span style="color: rgb(255, 255, 255);">&nbsp; &nbsp;</span><span style="color: rgb(0, 208, 132);">sa_family_t</span><span style="color: rgb(255, 255, 255);"> sin_family;&nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(247, 141, 167);">// 주소 체계 : ( AF_INET / AF_INET6 / AF_LOCAL )</span></div><div style="font-size: inherit; background-color: rgb(0, 0, 0);"><span style="color: rgb(255, 255, 255);">&nbsp; &nbsp;</span><span style="color: rgb(0, 208, 132);">uint16_t</span><span style="color: rgb(255, 255, 255);"> sin_port;</span><span style="font-size: inherit; color: rgb(255, 255, 255);">&nbsp; &nbsp; &nbsp;&nbsp;</span><span style="font-size: inherit; color: rgb(247, 141, 167);">// 16비트 TCP/UDP 포트번호 -&nbsp;</span><span style="color: rgb(235, 20, 76); font-size: inherit;">(네트워크 바이트 순서로 저장해야함.)</span></div><div style="background-color: rgb(0, 0, 0); font-size: inherit;"><span style="color: rgb(255, 255, 255);">&nbsp; &nbsp;</span><span style="color: rgb(0, 208, 132);">struct</span><span style="color: rgb(255, 255, 255);"> </span><span style="color: rgb(6, 147, 227);">in_addr</span><span style="color: rgb(255, 255, 255);"> sin_addr;</span><span style="font-size: inherit; color: rgb(255, 255, 255);">&nbsp; &nbsp; &nbsp;&nbsp;</span><span style="font-size: inherit; color: rgb(247, 141, 167);">// 32비트 IP 주소 - </span><span style="font-size: inherit; color: rgb(235, 20, 76);">(네트워크 바이트 순서로 저장해야함.)</span></div><div style="background-color: rgb(0, 0, 0); font-size: inherit;"><span style="color: rgb(255, 255, 255);">&nbsp; &nbsp;</span><span style="color: rgb(0, 208, 132);">char</span><span style="color: rgb(255, 255, 255);"> sin_zero[8];</span><span style="font-size: inherit; color: rgb(255, 255, 255);">&nbsp; &nbsp; &nbsp;&nbsp;</span><span style="font-size: inherit; color: rgb(247, 141, 167);">// 사용되지 않음. sockaddr과 크기를 일치시키기 위해 만들어놓은 것. 0으로 채움.</span></div><div style="background-color:#000000; font-size:inherit; color:#ffffff;">&nbsp;}</div>※<span style="font-size: inherit; background-color: rgb(255, 255, 255); font-style: italic;">bind()</span><span style="background-color: rgb(255, 255, 255); font-size: inherit;">는 </span><span style="font-size: inherit; background-color: rgb(255, 255, 255); font-style: italic;">sockaddr</span><span style="background-color: rgb(255, 255, 255); font-size: inherit;">을 필요로 하지만, 사용하기 불편하기 때문에, <span style="font-style: italic;">sockaddr_in</span>을 형변환해서 사용한다.</span></div><div style="font-size: inherit;">※<span style="font-style: italic; color: rgb(6, 147, 227); font-weight: bold;">in_addr</span>은 32비트 정수를 하나 가지고 있는 구조체다.<span style="background-color: rgb(255, 255, 255);"><span style="font-size: inherit;"><br></span></span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);"><span style="font-size: inherit;"><br></span></span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);"><span style="font-size: inherit;"><br></span></span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);"><span style="font-size: inherit; font-weight: bold;">네트워크의 바이트 순서</span></span><span style="font-size: inherit; font-weight: bold; background-color: rgb(255, 255, 255);">(빅-엔디안으로 만들기)</span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);">&gt; 네트워크의 바이트 순서는 <span style="text-decoration-line: underline;">빅-엔디안 방식</span>으로 통일한다. 이를 위해 다음과 같은 함수들이 있다.</span></div><div style="font-size: inherit;"><div style="font-size: inherit;"><div style=""><div style="background-color: rgb(0, 0, 0); font-size: inherit;"><div style=""><span style="color: rgb(6, 147, 227);">&nbsp;short 2byte : 주로 포트번호 변환에 사용한다.</span></div><div style=""><span style="color: rgb(255, 255, 255);">&nbsp; - </span><span style="color: rgb(0, 208, 132);">unsigned short</span><span style="color: rgb(255, 255, 255);"> htons(</span><span style="color: rgb(0, 208, 132);">unsigend short</span><span style="color: rgb(255, 255, 255);">); // short형 데이터를 host 바이트 순서 -&gt; network 바이트 순서</span></div><div style=""><span style="color: rgb(255, 255, 255);"><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span>- </span><span style="color: rgb(0, 208, 132);">unsigned short</span><span style="color: rgb(255, 255, 255);"> ntohs(</span><span style="color: rgb(0, 208, 132);">unsigned short</span><span style="color: rgb(255, 255, 255);">);&nbsp;</span><span style="color: rgb(255, 255, 255); font-size: inherit;">// short형 데이터를 network 바이트 순서 -&gt; host 바이트 순서</span></div><div style="color: rgb(0, 0, 0);"><span style="color: rgb(255, 255, 255); font-size: inherit;"><br></span></div><div style=""><span style="font-size: inherit; color: rgb(6, 147, 227);">&nbsp;long 4byte : 주로 IP주소 변환에 사용한다.</span></div><div style=""><span style="color: rgb(255, 255, 255);"><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span>- </span><span style="color: rgb(0, 208, 132);">unsigned long</span><span style="color: rgb(255, 255, 255);"> htonl(</span><span style="color: rgb(0, 208, 132);">unsigned long</span><span style="color: rgb(255, 255, 255);">);&nbsp;&nbsp;</span><span style="color: rgb(255, 255, 255); font-size: inherit;">// long형 데이터를 host 바이트 순서 -&gt; network 바이트 순서</span></div><div style=""><span style="color: rgb(255, 255, 255);"><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span>- </span><span style="color: rgb(0, 208, 132);">unsigned long</span><span style="color: rgb(255, 255, 255);"> ntohl(</span><span style="color: rgb(0, 208, 132);">unsigned long</span><span style="color: rgb(255, 255, 255);">);&nbsp;&nbsp;</span><span style="color: rgb(255, 255, 255); font-size: inherit;">// long형 데이터를 network 바이트 순서 -&gt; host 바이트 순서</span></div></div></div></div></div><div style="font-size: inherit;"><br></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);"><span style="font-size: inherit;"><br></span></span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);"><span style="font-size: inherit;"><br></span></span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);"><span style="font-size: inherit;"><b>문자열을 네트워크 바이트 순서의 정수로 변환하기 :&nbsp;</b></span></span><span style="background-color: rgb(255, 255, 255); font-weight: 700; font-size: inherit;">#include&lt;arpa/inet.h&gt;</span></div><div style="font-size: inherit;"><span style="font-weight: 700; background-color: rgb(255, 255, 255);">&gt; <span style="color: rgb(6, 147, 227);">in_addr_t</span> inet_addr(<span style="color: rgb(0, 208, 132);">const char*</span> string</span><span style="font-weight: 700; background-color: rgb(255, 255, 255);">)</span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);">"219.214.107.36"과 같은 IP주소를 <span style="text-decoration-line: underline;">32비트 정수</span>로 변환해준다.</span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);">성공 시 빅 엔디안으로 변환된 32비트 정수값, 실패 시 <span style="font-style: italic;"><u>INADDR_NONE</u></span> 반환</span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);">&nbsp;</span></div><div style="font-size: inherit;"><span style="font-weight: 700; background-color: rgb(255, 255, 255);">&gt; <span style="color: rgb(6, 147, 227);">int</span> inet_aton(<span style="color: rgb(0, 208, 132);">const char*</span> string, <span style="color: rgb(0, 208, 132);">struct </span><span style="color: rgb(6, 147, 227);">in_addr*</span><span style="color: rgb(0, 208, 132);">&nbsp;</span>addr</span><span style="font-weight: 700; background-color: rgb(255, 255, 255);">)</span><span style="background-color: rgb(255, 255, 255);"><span style="font-size: inherit;"><br></span></span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);">"219.214.107.36"과 같은 IP주소를 <span style="text-decoration-line: underline;">32비트 정수</span>로 변환해준다.</span><span style="background-color: rgb(255, 255, 255);"><br></span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);"><span style="font-style: italic;">string</span>: 변환할 IP주소,&nbsp;</span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);"><span style="font-style: italic;">addr</span>: 변환된 정보를 저장할 변수</span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255); color: rgb(6, 147, 227);">return: 성공은 1, 실패는 0 을 반환.</span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);"><span style="font-size: inherit;"><br></span></span></div><div style="font-size: inherit;"><span style="font-weight: 700; background-color: rgb(255, 255, 255);">&gt;&nbsp;<span style="color: rgb(6, 147, 227);">char*</span>&nbsp;inet_ntoa(<span style="color: rgb(0, 208, 132);">struct </span><span style="color: rgb(6, 147, 227);">in_addr</span><span style="color: rgb(0, 208, 132);">&nbsp;</span>addr</span><span style="font-weight: 700; background-color: rgb(255, 255, 255);">)</span><br></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);">정수형태의 IP주소를 문자열 형태의 IP주소로 변환한다.</span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);">함수 내부적으로 문자열을 메모리에 저장하고 변환하기 때문에, 다시 이 함수를 호출할 때 그 문자열이 달라질 수 있다. 따라서 <span style="font-style: italic;">strcpy</span> 같은 함수를 통해 배열에 저장해놓는 것이 좋다.</span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);"><br></span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);"><br></span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);"><br></span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255); font-weight: bold;">소켓에 주소 할당하기</span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);">&gt;&nbsp;</span><span style="font-size: inherit; font-weight: 700; background-color: rgb(255, 255, 255);"><span style="color: rgb(6, 147, 227);">int</span>&nbsp;bind(<span style="color: rgb(0, 208, 132);">int</span>&nbsp;sockfd,&nbsp;</span><span style="font-size: inherit; font-weight: 700; color: rgb(0, 208, 132);">struct </span><span style="font-size: inherit; font-weight: 700; color: rgb(6, 147, 227);">sockaddr</span><span style="font-size: inherit; font-weight: 700; color: rgb(0, 208, 132);">*</span><span style="font-size: inherit; font-weight: 700; background-color: rgb(255, 255, 255);">&nbsp;myaddr,&nbsp;</span><span style="font-size: inherit; font-weight: 700; color: rgb(0, 208, 132);">socklen_t</span><span style="font-size: inherit; font-weight: 700; background-color: rgb(255, 255, 255);">&nbsp;addrlen</span><span style="background-color: rgb(255, 255, 255); font-size: inherit; font-weight: 700;">)</span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);"><span style="font-style: italic;">socketfd</span> : 주소 정보(IP &amp; PORT)를 할당할 소켓의 파일 디스크립터.</span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);"><span style="font-style: italic;">myaddr</span> : 할당하고자 하는 주소정보를 지닌 구조체 변수의 주소.</span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);"><span style="font-style: italic;">addrlen</span> : 두 번째 인자로 전달된 구조체 변수의 길이.</span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255); color: rgb(6, 147, 227);">return : "성공시 0, 실패시 -1 반환"</span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);"><br></span></div><div style="font-size: inherit;"><br></div><div style="font-size: inherit;"><br></div><div style="font-size: inherit;"><span style="font-weight: bold;">연결요청 대기</span></div><div style="font-size: inherit;">&gt; <span style="font-weight: bold;"><span style="color: rgb(6, 147, 227);">int</span> listen(<span style="color: rgb(0, 208, 132);">int</span> sock, <span style="color: rgb(0, 208, 132);">int</span> backlog)</span></div><div style="font-size: inherit;"><span style="font-style: italic;">sock</span>:<span style="font-style: italic;">&nbsp;</span>리스닝 소켓(서버 소켓)의 파일 디스크립터.</div><div style="font-size: inherit;"><span style="font-style: italic;">backlog</span>: 연결요청 대기 Queue의 크기지정.</div><div style="font-size: inherit;"><span style="color: rgb(6, 147, 227);">return: "성공시 0, 실패시 -1 반환"</span></div><div style="font-size: inherit;"><span style="font-weight: bold;"><br></span></div><div style="font-size: inherit;"><span style="font-weight: bold;"><br></span></div><div style="font-size: inherit;"><span style="font-weight: bold;"><br></span></div><div style="font-size: inherit;"><span style="font-weight: bold;">연결요청 수락</span></div><div style="font-size: inherit;"><div><span style="font-size: inherit;">리스닝 소켓과는 별도로 클라이언트와 통신할 소켓이 필요하다.&nbsp;</span></div><div><span style="font-size: inherit;">아래 함수를 호출하면 알아서 소켓을 만들고 그 소켓의 디스크립터를 반환한다.</span></div><div><span style="font-size: inherit;">(클라이언트에서 connect 요청을 하기 전에 호출될 수 있다. 이러면 블로킹 상태로 기다리게 된다.)</span></div></div><div style="font-size: inherit;"><span style="font-weight: bold;">&gt;&nbsp;</span><span style="font-weight: bold; font-size: inherit; color: rgb(6, 147, 227);">int</span><span style="font-weight: bold; font-size: inherit;">&nbsp;accept</span><span style="font-weight: bold; font-size: inherit;">(</span><span style="font-weight: bold; font-size: inherit; color: rgb(0, 208, 132);">int</span><span style="font-weight: bold; font-size: inherit;">&nbsp;</span><span style="font-weight: bold; font-size: inherit;">sock,</span><span style="font-weight: bold; font-size: inherit;">&nbsp;</span><span style="font-weight: bold; font-size: inherit; color: rgb(0, 208, 132);">struct </span><span style="font-weight: bold; font-size: inherit; color: rgb(6, 147, 227);">sockaddr</span><span style="font-weight: bold; font-size: inherit; color: rgb(0, 208, 132);">*</span><span style="font-weight: bold; font-size: inherit;">&nbsp;addr,&nbsp;</span><span style="color: rgb(0, 208, 132); font-weight: 700; font-size: inherit;">socklen_t*&nbsp;</span><span style="font-size: inherit; font-weight: bold;">addrlen)</span></div><div style="font-size: inherit;"><span style="font-style: italic;">sock</span>:<span style="font-style: italic;">&nbsp;</span>리스닝 소켓(서버 소켓)의 파일 디스크립터.</div><div style="font-size: inherit;"><span style="font-style: italic;">addr</span>: 연결요청을 한 클라이언트의 주소정보를 담은 변수.</div><div style="font-size: inherit;"><span style="font-style: italic;">addrlen</span>: 두 번째 인자로 전달한 변수의 주소의 크기.<br></div><div style="font-size: inherit;"><span style="color: rgb(6, 147, 227);">return: "성공시 생성된 소켓의 디스크립터, 실패시 -1 반환"</span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);"><br></span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);"><br></span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);"><br></span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255); font-weight: bold;">연결요청하기</span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);">서버에서 <span style="font-style: italic;">listen() </span>이 호출되고 난 이후에는,&nbsp;</span><span style="background-color: rgb(255, 255, 255); font-size: inherit;">클라이언트에서 </span><span style="font-size: inherit; font-style: italic;">connect</span><span style="background-color: rgb(255, 255, 255); font-size: inherit;">() 를 통해 서버로 연결을 요청할 수 있다.</span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);">함수가 일단 호출되면, <span style="text-decoration-line: underline;">서버에 의해 연결요청이 접수</span>되거나,&nbsp;</span><span style="background-color: rgb(255, 255, 255); font-size: inherit;"><span style="text-decoration-line: underline;">오류상황이 발생해서 연결요청이 중단</span>되어야 함수 호출이 모두 완료된다.</span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255); font-size: inherit;">여기서 말하는 <span style="text-decoration-line: underline;">서버에 의한 연결 요청 접수</span>는 서버의 accpet 함수가 호출된 것을 의미하는 것이 아니라, 대기 Queue에 들어갔다는 것이므로 바로 서비스가 이뤄어지지 않을 수 있다.</span></div><div style="font-size: inherit;"><span style="font-weight: bold;">&gt;&nbsp;</span><span style="font-size: inherit; font-weight: bold; color: rgb(6, 147, 227);">int</span><span style="font-size: inherit; font-weight: bold;">&nbsp;connect</span><span style="font-size: inherit; font-weight: bold;">(</span><span style="font-size: inherit; font-weight: bold; color: rgb(0, 208, 132);">int</span><span style="font-size: inherit; font-weight: bold;">&nbsp;</span><span style="font-size: inherit; font-weight: bold;">sock,</span><span style="font-size: inherit; font-weight: bold;">&nbsp;</span><span style="font-size: inherit; font-weight: bold; color: rgb(0, 208, 132);">struct&nbsp;</span><span style="font-size: inherit; font-weight: bold; color: rgb(6, 147, 227);">sockaddr</span><span style="font-size: inherit; font-weight: bold; color: rgb(0, 208, 132);">*</span><span style="font-size: inherit; font-weight: bold;">&nbsp;servaddr,&nbsp;</span><span style="font-size: inherit; color: rgb(0, 208, 132); font-weight: 700;">socklen_t&nbsp;</span><span style="font-size: inherit; font-weight: bold;">addrlen)</span><br></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);"><span style="font-style: italic;">sock</span>: 클라이언트 소켓의 디스크립터.</span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);"><span style="font-style: italic;">servaddr</span>: 서버 주소 정보를 담은 변수의 주소.</span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);"><span style="font-style: italic;">addrlen</span>: 두 번째 인자로 넘겨진 주소의 변수의 크기.</span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);"><br></span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);">※서버 소켓과 달리, 클라이언트 소켓은 <span style="font-style: italic;">bind()</span> 를 통해 IP와 PORT를 따로 지정하지 않아도 되는데, 이는 <span style="font-style: italic;">connect()</span> 가 호출될 때 OS가 알아서 할당하기 때문이다.</span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);"><br></span></div><div style="font-size: inherit;"><br></div><div style=""><br><div style="background-color:#FCB900; font-size:inherit; color:#ffffff;"><span style="color: rgb(0, 0, 0); font-size: large; font-weight: 700;">TCP의 동작원리</span></div></div><div style="font-size: inherit;"><span style="font-weight: bold;">1. 상대 소켓과의 연결(Three-way handshaking)</span></div><div style="font-size: inherit;"><span style="font-weight: bold;">&nbsp; &gt;&gt;&nbsp;</span><span style="font-size: inherit; font-weight: bold;">[SYN]</span><span style="font-size: inherit;">&nbsp;</span><span style="font-weight: bold; font-size: inherit;">A to B :&nbsp;</span></div><div style="font-size: inherit;"><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">SEQ : 1000&nbsp; |&nbsp; ACK : -</span></div><div style="font-size: inherit;"><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;- SEQ: A가 보내는 패킷의 번호를 1000으로 정했다. 패킷을 받은 B는 다음 번호인 1001을 보내야한다.</span></div><div style="font-size: inherit;"><span style="font-size: inherit;"><br></span></div><div style="font-size: inherit;"><span style="font-weight: bold;">&nbsp; &gt;&gt;&nbsp;</span><span style="font-size: inherit; font-weight: bold;">[SYN+ACK]</span><span style="font-size: inherit;">&nbsp;<span style="font-weight: bold;">B</span></span><span style="font-weight: bold; font-size: inherit;">&nbsp;to A :&nbsp;</span></div><div style="font-size: inherit;"><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">SEQ : 2000&nbsp; |&nbsp; ACK : 1001</span></div><div style="font-size: inherit;"><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;- SEQ : B가 패킷의 번호를 2000으로 정했다. 패킷을 받은 A는 다음 번호인 2001을 보내야한다.</span></div><div style="font-size: inherit;"><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;-&nbsp;</span><span style="font-size: inherit;">ACK:&nbsp; A가 보냈던 1000 다음 번호인 1001이다. A의 패킷을 잘 받았음을 확인시켜준다.</span><span style="font-size: inherit;"><br></span></div><div style="font-size: inherit;">&nbsp;</div><div style="font-size: inherit;"><div><span style="font-weight: bold;">&nbsp; &gt;&gt;&nbsp;</span><span style="font-size: inherit; font-weight: bold;">[ACK]</span><span style="font-size: inherit;">&nbsp;</span><span style="font-weight: bold; font-size: inherit;">A to B :&nbsp;</span></div><div><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">SEQ : 1001&nbsp; |&nbsp; ACK : 2001</span></div><div><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;- SEQ : 다음의 메시지 전달을 목적으로 전송한다.</span><span style="font-size: inherit;"><br></span></div><div><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;- ACK : B에서 보냈던 2000 다음 번호인 2001이다. B의 패킷을 잘 받았음을 확인시켜준다.</span><br></div><div><span style="font-size: inherit;"><br></span></div></div><div style="font-size: inherit;"><br></div><div style="font-size: inherit;"><span style="font-weight: bold;">2. 데이터 송수신</span></div><div style="font-size: inherit;"><div style="font-size: inherit;"><span style="font-weight: bold;">&nbsp; &gt;&gt; A to B :&nbsp;</span></div></div><div style="font-size: inherit;"><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;SEQ : 1200 | 100 byte data</span><br></div><div style="font-size: inherit;"><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;"><br></span></div><div style="font-size: inherit;"><div style="font-size: inherit;"><div style="font-size: inherit;"><span style="font-weight: bold;">&nbsp; &gt;&gt; B&nbsp;to A :&nbsp;</span></div></div><div style="font-size: inherit;"><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;ACK : 1301</span></div><div style="font-size: inherit;"><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;- <span style="background-color: rgb(255, 255, 255); text-decoration-line: underline;">ACK = A에서 보낸 SEQ + 전송 바이트 크기 + 1 </span>= 1200 + 100 + 1 = 1301.</span><span style="font-size: inherit;"><br></span></div><div style="font-size: inherit;"><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;- 전송 바이트 크기를 더함으로써 패킷을 잘 받았음을 확인시켜준다.</span><span style="font-size: inherit;"><br></span></div><div style="font-size: inherit;"><span style="font-size: inherit;"><br></span></div></div><div style="font-size: inherit;">&nbsp; ※만약 패킷을 보내고 응답을 받지 못하면, 타이머를 동작시켜서 timeout이 되면 패킷 재전송을 진행한다.</div><div style="font-size: inherit;"><span style="font-size: inherit;"><br></span></div><div style="font-size: inherit;"><span style="font-size: inherit;"><br></span></div><div style="font-size: inherit;"><span style="font-weight: bold;">3. 연결종료(Four-way handshaking)</span></div><div style="font-size: inherit;"><div style="font-size: inherit;"><span style="font-weight: bold;">&nbsp; &gt;&gt;&nbsp;</span><span style="font-size: inherit; font-weight: bold;">[FIN]</span><span style="font-size: inherit;">&nbsp;</span><span style="font-weight: bold; font-size: inherit;">A to B :&nbsp;</span></div><div style="font-size: inherit;"><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">SEQ : 5000&nbsp; |&nbsp; ACK : -</span></div><div style="font-size: inherit;"><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;- 연결 해제를 요청한다.</span><span style="font-size: inherit;"><br></span></div><div style="font-size: inherit;"><br></div><div style="font-size: inherit;"><span style="font-weight: bold;">&nbsp; &gt;&gt;&nbsp;</span><span style="font-size: inherit; font-weight: bold;">[ACK]</span><span style="font-size: inherit;">&nbsp;<span style="font-weight: bold;">B</span></span><span style="font-weight: bold; font-size: inherit;">&nbsp;to A :&nbsp;</span></div><div style="font-size: inherit;"><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">SEQ : 7500&nbsp; |&nbsp; ACK : 5001</span></div><div style="font-size: inherit;"><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;- A의 요청을 받았음을 확인시켜준다.</span></div><div style="font-size: inherit;">&nbsp;</div><div style="font-size: inherit;"><div><span style="font-weight: bold;">&nbsp; &gt;&gt;&nbsp;</span><span style="font-size: inherit; font-weight: bold;">[FIN]</span><span style="font-size: inherit;">&nbsp;<span style="font-weight: bold;">B</span></span><span style="font-weight: bold; font-size: inherit;">&nbsp;to A :&nbsp;</span></div><div><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">SEQ : 7501&nbsp; |&nbsp; ACK : 5001</span></div><div><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;- B도 연결 해제를 요청한다.</span></div><div><span style="font-size: inherit;"><br></span></div></div></div><div style="font-size: inherit;"><div style="font-size: inherit;"><div style="font-size: inherit;"><div><span style="font-weight: bold;">&nbsp; &gt;&gt;&nbsp;</span><span style="font-size: inherit; font-weight: bold;">[ACK]</span><span style="font-size: inherit;">&nbsp;<span style="font-weight: bold;">A</span></span><span style="font-weight: bold; font-size: inherit;">&nbsp;to B :&nbsp;</span></div><div><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">SEQ : 5001&nbsp; |&nbsp; ACK : 7502</span></div><div><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;</span><span style="font-size: inherit;">&nbsp;- B의 요청을 받았음을 응답한다.</span></div></div></div><div style="font-size: inherit;"><br></div></div><div style="font-size: inherit;"><br></div><div style="font-size: inherit;"><br></div><div style="font-size: inherit;"><div style="background-color:#FCB900; font-size:inherit; color:#ffffff;"><span style="font-size: large; font-weight: 700; color: rgb(0, 0, 0);">UDP의 동작원리</span></div></div><div style="font-size: inherit;"><span style="font-weight: bold;">UDP란?</span></div><div style="font-size: inherit;">TCP와는 달리 UDP는 흐름제어가 없기 때문에 신뢰할 수 없는 프로토콜이다.&nbsp;</div><div style="font-size: inherit;"><span style="font-size: inherit;">그러나 UDP는 TCP보다 훨씬 <span style="text-decoration-line: underline;">빠르고</span>, 손실이 일어나기는 하지만 그래도 생각보다는 신뢰할만하다.</span></div><div style="font-size: inherit;">(TCP는 송수신 전/후에 거치는 연결설정/해제 과정과, 송수신 과정에서 거치는 신뢰성 보장을 위한 흐름제어 때문에 속도가 느리다.)</div><div style="font-size: inherit;"><br></div><div style="font-size: inherit;">하나의 패킷도 손실되지 말아야하는 압축파일을 전송하는 경우에는 TCP를 써야하지만,&nbsp;</div><div style="font-size: inherit;">실시간 멀티미디어 데이터를 전달하는 경우처럼 약간의 패킷 손실이 일어나도 괜찮은 경우에는 UDP를 고려할만하다.&nbsp;</div><div style="font-size: inherit;"><span style="font-size: inherit;">특히 보낼 데이터의 양은 작은데, 잦은 연결이 필요한 경우 UDP는 TCP보다 훨씬 효율적이면서 빠르게 동작한다.</span></div><div style="font-size: inherit;"><br></div><div style="font-size: inherit;">- UDP에서 서버와 클라이언트는 <span style="text-decoration-line: underline;">연결되어 있지 않으며</span>, 따라서&nbsp;<span style="font-style: italic;">listen()</span>과 <span style="font-style: italic;">accept()</span>가 불필요하다.</div><div style="font-size: inherit;">- UDP에서는 서버와 클라이언트에서 모두 <span style="text-decoration-line: underline;">하나의 소켓만 있으면 둘 이상의 호스트와 통신이 가능</span>하다.</div><div style="font-size: inherit;">- UDP는 데이터의 경계가 있는 프로토콜이므로, <u>입력함수의 호출횟수와 출력함수의 호출횟수가 정확히 일치해야 데이터를 온전히 수신</u>할 수 있다.</div><div style="font-size: inherit;"><br></div><div style="font-size: inherit;"><br></div><div style="font-size: inherit;"><span style="font-weight: bold;">UDP 기반 데이터 입출력 함수</span></div><div style="font-size: inherit;">UDP는 서버와 클라이언트가 연결되어 있지 않기 때문에, 함수에 목적지 주소 정보를 넣어준다.</div><div style="font-size: inherit;"><br></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);">&gt;&nbsp;</span><span style="font-size: inherit; font-weight: 700; background-color: rgb(255, 255, 255);">ssize_t&nbsp;sendto(int&nbsp;<span style="color: rgb(255, 105, 0);">sock</span>, void*</span><span style="font-weight: 700; background-color: rgb(255, 255, 255);">&nbsp;<span style="color: rgb(252, 185, 0);">buff</span></span><span style="font-size: inherit; font-weight: 700; background-color: rgb(255, 255, 255);">,&nbsp;</span><span style="font-weight: 700;">size_t</span><span style="font-weight: 700; background-color: rgb(255, 255, 255);">&nbsp;<span style="color: rgb(0, 208, 132);">nbytes</span>,&nbsp;</span><span style="font-weight: 700;">int</span><span style="font-weight: 700; background-color: rgb(255, 255, 255);">&nbsp;<span style="color: rgb(6, 147, 227);">flags</span>,&nbsp;</span><span style="font-size: inherit; font-weight: 700;">struct&nbsp;</span><span style="font-size: inherit; font-weight: 700;">sockaddr</span><span style="font-size: inherit; font-weight: 700;">*</span><span style="font-size: inherit; font-weight: 700; background-color: rgb(255, 255, 255);">&nbsp;<span style="color: rgb(235, 20, 76);">to</span>,&nbsp;</span><span style="font-size: inherit; font-weight: 700;">socklen_t</span><span style="font-size: inherit; font-weight: 700; background-color: rgb(255, 255, 255);">&nbsp;<span style="color: rgb(153, 0, 239);">addrlen</span></span><span style="font-size: inherit; background-color: rgb(255, 255, 255); font-weight: 700;">)</span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);">데이터를 전송할 때 사용하며, 성공시에는 전송된 바이트의 수를, 실패시에는 -1을 반환한다.</span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);">&nbsp;</span><span style="background-color: rgb(255, 255, 255);">&nbsp;-&nbsp;</span><span style="font-size: inherit; background-color: rgb(255, 255, 255);"><span style="color: rgb(255, 105, 0);">sock&nbsp;</span>:&nbsp; &nbsp; &nbsp; 사용할 UDP 소켓의 파일 디스크립터</span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);">&nbsp;</span><span style="background-color: rgb(255, 255, 255);">&nbsp;-&nbsp;</span><span style="background-color: rgb(255, 255, 255);"><span style="color: rgb(252, 185, 0);">buff</span></span><span style="background-color: rgb(255, 255, 255);">:&nbsp; &nbsp; &nbsp; &nbsp;전송할 데이터를 저장하고 있는 버퍼의 주소 값</span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);">&nbsp;</span><span style="background-color: rgb(255, 255, 255);">&nbsp;-&nbsp;</span><span style="background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 208, 132);">nbytes</span></span><span style="background-color: rgb(255, 255, 255);">:&nbsp; &nbsp;전송할 데이터의 크기를 바이트 단위로 전달</span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);">&nbsp;</span><span style="background-color: rgb(255, 255, 255);">&nbsp;-&nbsp;</span><span style="background-color: rgb(255, 255, 255);"><span style="color: rgb(6, 147, 227);">flags</span></span><span style="background-color: rgb(255, 255, 255);">:&nbsp; &nbsp; &nbsp; 옵션 지정에 사용되는 매개변수. 없다면 0</span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);">&nbsp;</span><span style="background-color: rgb(255, 255, 255);">&nbsp;-&nbsp;</span><span style="font-size: inherit; background-color: rgb(255, 255, 255);"><span style="color: rgb(235, 20, 76);">to</span></span><span style="background-color: rgb(255, 255, 255);">:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 목적지 주소 정보를 담고 있는 sockaddr 구조체 변수의 주소 값.</span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);">&nbsp;</span><span style="background-color: rgb(255, 255, 255);">&nbsp;-&nbsp;</span><span style="font-size: inherit; background-color: rgb(255, 255, 255);"><span style="color: rgb(153, 0, 239);">addrlen</span></span><span style="background-color: rgb(255, 255, 255);">: 매개변수 to로 전달된 구조체 변수의 크기</span></div><div style="font-size: inherit;"><br></div><div style="font-size: inherit;"><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);">&gt;&nbsp;</span><span style="font-size: inherit; font-weight: 700; background-color: rgb(255, 255, 255);">ssize_t recvfrom(int&nbsp;<span style="color: rgb(255, 105, 0);">sock</span>, void*</span><span style="font-weight: 700; background-color: rgb(255, 255, 255);">&nbsp;<span style="color: rgb(252, 185, 0);">buff</span></span><span style="font-size: inherit; font-weight: 700; background-color: rgb(255, 255, 255);">,&nbsp;</span><span style="font-weight: 700;">size_t</span><span style="font-weight: 700; background-color: rgb(255, 255, 255);">&nbsp;<span style="color: rgb(0, 208, 132);">nbytes</span>,&nbsp;</span><span style="font-weight: 700;">int</span><span style="font-weight: 700; background-color: rgb(255, 255, 255);">&nbsp;<span style="color: rgb(6, 147, 227);">flags</span>,&nbsp;</span><span style="font-size: inherit; font-weight: 700;">struct&nbsp;</span><span style="font-size: inherit; font-weight: 700;">sockaddr</span><span style="font-size: inherit; font-weight: 700;">*</span><span style="font-size: inherit; font-weight: 700; background-color: rgb(255, 255, 255);">&nbsp;<span style="color: rgb(235, 20, 76);">from</span>,&nbsp;</span><span style="font-size: inherit; font-weight: 700;">socklen_t*</span><span style="font-size: inherit; font-weight: 700; background-color: rgb(255, 255, 255);">&nbsp;<span style="color: rgb(153, 0, 239);">addrlen</span></span><span style="font-size: inherit; background-color: rgb(255, 255, 255); font-weight: 700;">)</span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);">데이터를 수신할 때 사용하며, 성공시에는 수신한 바이트의 수를, 실패시에는 -1을 반환한다.</span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);">&nbsp;</span><span style="background-color: rgb(255, 255, 255);">&nbsp;-&nbsp;</span><span style="font-size: inherit; background-color: rgb(255, 255, 255);"><span style="color: rgb(255, 105, 0);">sock&nbsp;</span>:&nbsp; &nbsp; &nbsp; 사용할 UDP 소켓의 파일 디스크립터</span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);">&nbsp;</span><span style="background-color: rgb(255, 255, 255);">&nbsp;-&nbsp;</span><span style="background-color: rgb(255, 255, 255);"><span style="color: rgb(252, 185, 0);">buff</span></span><span style="background-color: rgb(255, 255, 255);">:&nbsp; &nbsp; &nbsp; &nbsp;수신할 데이터를 저장할 버퍼의 주소 값</span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);">&nbsp;</span><span style="background-color: rgb(255, 255, 255);">&nbsp;-&nbsp;</span><span style="background-color: rgb(255, 255, 255);"><span style="color: rgb(0, 208, 132);">nbytes</span></span><span style="background-color: rgb(255, 255, 255);">:&nbsp; &nbsp;수신할 데이터의 최대 크기를 바이트 단위로 전달</span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);">&nbsp;</span><span style="background-color: rgb(255, 255, 255);">&nbsp;-&nbsp;</span><span style="background-color: rgb(255, 255, 255);"><span style="color: rgb(6, 147, 227);">flags</span></span><span style="background-color: rgb(255, 255, 255);">:&nbsp; &nbsp; &nbsp; 옵션 지정에 사용되는 매개변수.&nbsp;</span><span style="background-color: rgb(255, 255, 255); font-size: inherit;">없다면 0</span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);">&nbsp;</span><span style="background-color: rgb(255, 255, 255);">&nbsp;- <span style="color: rgb(235, 20, 76);">from</span></span><span style="background-color: rgb(255, 255, 255);">:&nbsp; &nbsp; &nbsp; 발신지 주소 정보를 담고 있는 sockaddr 구조체 변수의 주소 값.</span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);">&nbsp;</span><span style="background-color: rgb(255, 255, 255);">&nbsp;-&nbsp;</span><span style="font-size: inherit; background-color: rgb(255, 255, 255);"><span style="color: rgb(153, 0, 239);">addrlen</span></span><span style="background-color: rgb(255, 255, 255);">: 매개변수 from로 전달된 구조체 변수의 크기를 담고 있는 변수의 주소값.</span></div><div style="font-size: inherit;"><br></div></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);">※서버 소켓과 달리, 클라이언트 소켓은&nbsp;</span><span style="font-style: italic;">bind()</span><span style="background-color: rgb(255, 255, 255);">&nbsp;를 통해 IP와 PORT를 따로 지정하지 않아도 되는데, 이는&nbsp;<i>sendto() </i>함수가 호출되는 시점에 해당 소켓에 IP와 PORT가 자동으로 할당되기 때문이다.</span><br></div><div style="font-size: inherit;"><br></div><div style="font-size: inherit;"><br></div><div style="font-size: inherit;"><b>Connected UDP Socket / Unconnected UDP Socket</b></div><div style="font-size: inherit;">TCP와는 달리 UDP 소켓에서는 목적지의 IP와 PORT를 등록하지 않는다고 했다.&nbsp;</div><div style="font-size: inherit;"><i>sendto()</i>&nbsp;함수호출을 통한 과정을 구분하면 아래와 같다.</div><div style="font-size: inherit;"><br></div><div style="font-size: inherit;">&nbsp; <span style="text-decoration-line: underline;">1. UDP 소켓에 목적지의 IP와 PORT 등록</span></div><div style="font-size: inherit;">&nbsp; <span style="text-decoration-line: underline;">2. 데이터 전송</span></div><div style="font-size: inherit;">&nbsp; <span style="text-decoration-line: underline;">3. UDP 소켓에 등록된 목적지 정보 삭제</span></div><div style="font-size: inherit;"><i><br></i></div><div style="font-size: inherit;"><i>sendto()</i> 함수가 호출될 때마다 위 과정이 반복되기 때문에, 하나의 소켓을 가지고 여러 목적지로 데이터를 보낼 수가 있다.</div><div style="font-size: inherit;">목적지 정보가 등록되어 있는 소켓을 <span style="font-style: italic;">connected UDP socket, </span>등록되어 있지 않은 소켓을 <span style="font-style: italic;">unconnected UDP socket</span>이라고 부른다.&nbsp;</div><div style="font-size: inherit;">기본적으로 UDP 소켓은 <span style="font-style: italic;">unconnected UDP socket</span>&nbsp;이지만, 같은 목적지로 sendto() 를 여러번 호출한다면 비효율적일 것이다.&nbsp; 따라서&nbsp;<span style="font-size: inherit;">소켓을 </span><span style="font-size: inherit; font-style: italic;">connected UDP socket</span><span style="font-size: inherit;">으로 바꾸면 쓸데없는 등록/삭제 과정없이 전송만 하면 되기 때문에 성능향상을 기대할 수 있다.</span></div><div style="font-size: inherit;"><br></div><div style="font-size: inherit;"><br></div><div style="font-size: inherit;"><span style="font-weight: bold;">conncted UDP socket 생성</span></div><div style="font-size: inherit;">UDP 소켓을 대상으로 <span style="font-style: italic;">connect() </span>를 호출하면 된다.&nbsp;</div><div style="font-size: inherit;">이때 <span style="font-style: italic;">connect()</span> 는 UDP 소켓에 목적지의 정보를 등록시켜주는 기능을 수행한다.</div><div style="font-size: inherit;">일단 목적지 정보가 등록되고 나면&nbsp;<span style="font-style: italic;">write(), read() </span>로 데이터 송수신을 할 수 있다.</div><div style="font-size: inherit;"><br></div><div style="font-size: inherit;"><br></div><div style="font-size: inherit;"><br></div><div style="font-size: inherit;"><br></div><div style="font-size: inherit;"><br></div><div style="font-size: inherit;"><br></div><div style="font-size: inherit;"><br></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);"><br></span></div><div style="font-size: inherit;"><span style="background-color: rgb(255, 255, 255);"><br></span></div></div></div>